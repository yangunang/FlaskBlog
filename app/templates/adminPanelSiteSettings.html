{% extends 'layout.html' %}

{% block head %}
<title>Site Settings - Admin Panel</title>
{% endblock head %}

{% block body %}
<div class="container mx-auto px-4 py-8 max-w-6xl">
    <!-- Page Header -->
    <div class="flex items-center justify-between mb-8">
        <h1 class="text-3xl font-bold text-rose-500">
            <i class="ti ti-settings mr-2"></i>
            Site Settings
        </h1>
        <a href="/admin" class="btn btn-ghost">
            <i class="ti ti-arrow-left mr-2"></i>
            Back to Admin Panel
        </a>
    </div>

    <!-- Site Logo Section -->
    <h2 class="text-2xl font-bold mb-4">
        <i class="ti ti-photo mr-2"></i>
        Site Logo
    </h2>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Current Logo Display -->
        <div class="card bg-base-100 shadow-xl h-full">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-eye mr-2"></i>
                    Current Logo
                </h3>

                <div class="flex justify-center items-center p-6 bg-base-100 rounded-lg">
                    <img
                        src="{{ currentLogo }}"
                        alt="Current Site Logo"
                        class="max-w-xs max-h-40 object-contain rounded shadow-lg"
                    />
                </div>

                <div class="mt-4 text-center">
                    <p class="text-sm opacity-75">
                        <i class="ti ti-info-circle mr-1"></i>
                        Path: <code class="bg-base-300 px-2 py-1 rounded text-xs">{{ currentLogo }}</code>
                    </p>
                </div>
            </div>
        </div>

        <!-- Upload New Logo Form -->
        <div class="card bg-base-200 shadow-xl h-full">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-upload mr-2"></i>
                    Upload New Logo
                </h3>

                <form method="POST" enctype="multipart/form-data" class="space-y-4">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                    <input type="hidden" name="upload_type" value="site_logo" />

                    <div class="form-control">
                        <input
                            type="file"
                            name="site_logo"
                            accept=".ico,.png,.jpg,.jpeg,.webp"
                            class="file-input file-input-bordered file-input-primary w-full"
                            required
                        />
                        <label class="label">
                            <span class="label-text-alt">
                                <i class="ti ti-info-circle mr-1"></i>
                                .ico, .png, .jpg, .jpeg, .webp (180x180px)
                            </span>
                        </label>
                    </div>

                    <div class="card-actions justify-end">
                        <button type="submit" class="btn btn-primary btn-sm">
                            <i class="ti ti-upload mr-2"></i>
                            Upload
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Default Profile Picture Section -->
    <h2 class="text-2xl font-bold mb-4">
        <i class="ti ti-user-circle mr-2"></i>
        Default Profile Picture
    </h2>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Current Default Profile Picture Display -->
        <div class="card bg-base-100 shadow-xl h-full">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-eye mr-2"></i>
                    Current Picture
                </h3>

                {% if currentDefaultProfile %}
                <div class="flex justify-center items-center p-6 bg-base-100 rounded-lg">
                    <img
                        src="{{ currentDefaultProfile }}"
                        alt="Current Default Profile Picture"
                        class="max-w-xs max-h-40 object-contain rounded-full shadow-lg"
                    />
                </div>

                <div class="mt-4 text-center">
                    <p class="text-sm opacity-75">
                        <i class="ti ti-info-circle mr-1"></i>
                        Path: <code class="bg-base-300 px-2 py-1 rounded text-xs">{{ currentDefaultProfile }}</code>
                    </p>
                </div>
                {% else %}
                <div class="alert alert-warning">
                    <i class="ti ti-alert-circle"></i>
                    <span class="text-sm">No default profile picture set. Using DiceBear avatars.</span>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Upload Default Profile Picture Form -->
        <div class="card bg-base-200 shadow-xl h-full">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-upload mr-2"></i>
                    Upload New Picture
                </h3>

                <form method="POST" enctype="multipart/form-data" class="space-y-4">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                    <input type="hidden" name="upload_type" value="default_profile_picture" />

                    <div class="form-control">
                        <input
                            type="file"
                            name="default_profile_picture"
                            accept="image/jpeg,image/jpg,image/png,image/webp"
                            class="file-input file-input-bordered file-input-primary w-full"
                            required
                        />
                        <label class="label">
                            <span class="label-text-alt">
                                <i class="ti ti-info-circle mr-1"></i>
                                .jpg, .jpeg, .png, .webp (200x200px square)
                            </span>
                        </label>
                    </div>

                    <div class="card-actions justify-end">
                        <button type="submit" class="btn btn-primary btn-sm">
                            <i class="ti ti-upload mr-2"></i>
                            Upload
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Default Banner Section -->
    <h2 class="text-2xl font-bold mb-4">
        <i class="ti ti-photo mr-2"></i>
        Default Profile Banner
    </h2>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Current Default Banner Display - Full width for better preview -->
        <div class="card bg-base-100 shadow-xl lg:col-span-2">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-eye mr-2"></i>
                    Current Banner
                </h3>

                {% if currentDefaultBanner %}
                <div class="flex justify-center items-center p-6 bg-base-200 rounded-lg">
                    <img
                        src="{{ currentDefaultBanner }}"
                        alt="Current Default Banner"
                        class="w-full max-h-48 object-contain rounded shadow-lg"
                    />
                </div>

                <div class="mt-4 text-center">
                    <p class="text-sm opacity-75">
                        <i class="ti ti-info-circle mr-1"></i>
                        Path: <code class="bg-base-300 px-2 py-1 rounded text-xs">{{ currentDefaultBanner }}</code>
                    </p>
                </div>
                {% else %}
                <div class="alert alert-warning">
                    <i class="ti ti-alert-circle"></i>
                    <span class="text-sm">No default banner set.</span>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Upload Default Banner Form - Full width -->
        <div class="card bg-base-200 shadow-xl lg:col-span-2">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-upload mr-2"></i>
                    Upload New Banner
                </h3>

                <form method="POST" enctype="multipart/form-data" class="space-y-4">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                    <input type="hidden" name="upload_type" value="default_banner" />

                    <div class="form-control">
                        <input
                            type="file"
                            name="default_banner"
                            accept="image/jpeg,image/jpg,image/png,image/webp"
                            class="file-input file-input-bordered file-input-primary w-full"
                            required
                        />
                        <label class="label">
                            <span class="label-text-alt">
                                <i class="ti ti-info-circle mr-1"></i>
                                .jpg, .jpeg, .png, .webp (1500x500px, 3:1 ratio)
                            </span>
                        </label>
                    </div>

                    <div class="card-actions justify-end">
                        <button type="submit" class="btn btn-primary btn-sm">
                            <i class="ti ti-upload mr-2"></i>
                            Upload
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- SMTP Configuration Section -->
    <h2 class="text-2xl font-bold mb-4">
        <i class="ti ti-mail-cog mr-2"></i>
        SMTP Configuration
    </h2>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- SMTP Settings Form -->
        <div class="card bg-base-100 shadow-xl h-full">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-settings mr-2"></i>
                    Settings
                </h3>

                <form method="POST" class="space-y-4">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                    <input type="hidden" name="upload_type" value="smtp_config" />

                    <div class="grid grid-cols-2 gap-4">
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold text-sm">Server</span>
                            </label>
                            <input
                                type="text"
                                name="smtp_server"
                                value="{{ smtpServer }}"
                                placeholder="smtp.gmail.com"
                                class="input input-bordered input-sm w-full"
                            />
                        </div>

                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold text-sm">Port</span>
                            </label>
                            <input
                                type="number"
                                name="smtp_port"
                                value="{{ smtpPort }}"
                                placeholder="587"
                                min="1"
                                max="65535"
                                class="input input-bordered input-sm w-full"
                            />
                        </div>
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold text-sm">Email</span>
                        </label>
                        <input
                            type="email"
                            name="smtp_mail"
                            value="{{ smtpMail }}"
                            placeholder="your-email@gmail.com"
                            class="input input-bordered input-sm w-full"
                        />
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold text-sm">Password</span>
                        </label>
                        <input
                            type="password"
                            name="smtp_password"
                            placeholder="Enter new password"
                            class="input input-bordered input-sm w-full"
                        />
                        {% if smtpPasswordSet %}
                        <label class="label">
                            <span class="label-text-alt text-success">
                                <i class="ti ti-check mr-1"></i>
                                Password is set
                            </span>
                        </label>
                        {% endif %}
                    </div>

                    <div class="card-actions justify-end">
                        <button type="submit" class="btn btn-primary btn-sm">
                            <i class="ti ti-device-floppy mr-2"></i>
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Test SMTP Section -->
        <div class="card bg-base-200 shadow-xl h-full">
            <div class="card-body">
                <h3 class="card-title text-lg mb-4">
                    <i class="ti ti-mail-check mr-2"></i>
                    Test Configuration
                </h3>

                <form method="POST" class="space-y-4">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                    <input type="hidden" name="upload_type" value="smtp_test" />

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold text-sm">Recipient Email</span>
                        </label>
                        <input
                            type="email"
                            name="test_email"
                            placeholder="Enter email address"
                            class="input input-bordered input-sm w-full"
                            required
                        />
                    </div>

                    <div class="alert alert-warning text-sm py-2">
                        <i class="ti ti-alert-triangle"></i>
                        <span>For Gmail, use an App Password instead of your regular password.</span>
                    </div>

                    <div class="card-actions justify-end">
                        <button type="submit" class="btn btn-secondary btn-sm">
                            <i class="ti ti-send mr-2"></i>
                            Send Test
                        </button>
                    </div>
                </form>

                <div class="divider my-2"></div>

                <div class="text-sm opacity-75">
                    <p class="font-semibold mb-1">SMTP Usage:</p>
                    <ul class="list-disc list-inside space-y-1 text-xs">
                        <li>Password reset emails</li>
                        <li>Account verification</li>
                        <li>System notifications</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

{% include 'components/flash.html' %}
{% endblock body %}
